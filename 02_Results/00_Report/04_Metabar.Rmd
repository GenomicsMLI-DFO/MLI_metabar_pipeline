---
title: "Metabar filtering"
author: "Audrey Bourret"
date: "17/02/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = here::here())

source(file.path(here::here(), "01_Code", "Functions", "get.value.R"))
library(tidyverse)

LOCUS <- stringr::str_split(get.value("Loci", file = file.path(here::here(), "Options.txt")), pattern = ";")[[1]]

```

## Reads distribution

```{r echo=FALSE, message=FALSE, warning=FALSE}

graph0 <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/00_plate_ori_",LOCUS,".png)")

```

`r graph0`

## Sequencing depth

The orange line is the threshold

```{r echo=FALSE, message=FALSE, warning=FALSE}

graph1 <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/01_depth_",LOCUS,".png)")

```

`r graph1`


## Distribution of most abundant contaminant


```{r echo=FALSE, message=FALSE, warning=FALSE}

graph2 <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/02_plate_conta_",LOCUS,".png)")

```

`r graph2`

## Proportion of contaminant in each samples

orange = threshold


```{r echo=FALSE, message=FALSE, warning=FALSE}

graph3 <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/03_conta.prop_",LOCUS,".png)")

```

`r graph3`

## Tag jumping

### Testing parameters

```{r echo=FALSE, message=FALSE, warning=FALSE}

graph4a <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/04_tagjump.threshold_",LOCUS,".png)")

```

`r graph4a`


### Exemple for the most abundant ESV

```{r echo=FALSE, message=FALSE, warning=FALSE}
graph4b <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/04_tagjump.plate_",LOCUS,".png)")

```

`r graph4b`


## Summary for contaminant


```{r echo=FALSE, message=FALSE, warning=FALSE}
graph5a <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/05_summary.conta_",LOCUS,".png)")

```

`r graph5a`


```{r echo=FALSE, message=FALSE, warning=FALSE}
graph5b <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/05_summary.conta_byProject_",LOCUS,".png)")

```

`r graph5b`


## Summary post correction

### In diversity and abundance

```{r echo=FALSE, message=FALSE, warning=FALSE}
graph6a <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/06_summary.postcorrection_",LOCUS,".png)")

```

`r graph6a`

### In global genus observed

```{r echo=FALSE, message=FALSE, warning=FALSE}
graph6b <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/06_overall.original_",LOCUS,".png)")

```

`r graph6b`

```{r echo=FALSE, message=FALSE, warning=FALSE}
graph6c <- paste0("![](", here::here(), "/02_Results/04_ESVtable_correction/06_overall.postcorrection_",LOCUS,".png)")

```

`r graph6c`

